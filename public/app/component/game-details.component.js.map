{"version":3,"sources":["../src/ts/app/component/game-details.component.ts"],"names":[],"mappings":"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","file":"game-details.component.js","sourcesContent":["import { \r\n    Component,\r\n    OnInit,\r\n    OnDestroy,\r\n    Input,\r\n    Output,\r\n    EventEmitter,\r\n    trigger,\r\n    state,\r\n    style,\r\n    transition,\r\n    animate\r\n} from '@angular/core';\r\nimport { Router, ActivatedRoute, Params }   from '@angular/router';\r\nimport { Location }   from '@angular/common';\r\n\r\nimport { AppComponent } from \"./app.component\";\r\n\r\nimport { GameDatabaseService } from '../service/game-database.service';\r\n\r\nimport { Game } from '../model/game';\r\nimport { Name } from '../model/name';\r\nimport { PlayerCount } from '../model/player-count';\r\nimport { Duration } from '../model/duration';\r\nimport { Tag } from '../model/tag';\r\nimport { Note } from '../model/note';\r\n\r\nimport { Tool } from './toolbar.component';\r\n\r\nimport { UserService } from \"../service/user.service\";\r\n\r\n@Component({\r\n    moduleId: module.id,\r\n    selector: '.page.ng-game-details',\r\n    templateUrl: '../template/game-details.component.html',\r\n    animations: [\r\n        trigger('expand', [\r\n            state('in', style({height: '*'})),\r\n            transition('void => *', [\r\n                style({height: 0}),\r\n                animate(100)\r\n            ]),\r\n            transition('* => void', [\r\n                style({height: '*'}),\r\n                animate(100, style({height: 0}))\r\n            ])\r\n        ])\r\n    ]\r\n})\r\nexport class GameDetailsComponent implements OnInit, OnDestroy {\r\n\r\n    @Input() game: Game;\r\n    @Output() onClose: EventEmitter<Tool> = new EventEmitter();\r\n\r\n    dialog: boolean = false;\r\n\r\n    playerCount: PlayerCount;\r\n    duration: Duration;\r\n    tags: Tag[] = [];\r\n    tagMap: Object = {};\r\n    notes: Note[] = [];\r\n\r\n    scrollpos: number = 0;\r\n\r\n    namesOpen: boolean = false;\r\n\r\n    showToolbarScrollPosition: number = window.innerWidth * 0.15;\r\n\r\n    permissions: Object = {};\r\n\r\n    private tools: Tool[] = [\r\n        {\r\n            icon: \"fa-trash\",\r\n            name: \"deleteGame\",\r\n            text: \"Delete Game\",\r\n            permission: \"game_delete\"\r\n        },\r\n        {\r\n            icon: \"fa-random\",\r\n            name: \"randomGame\",\r\n            text: \"Select Random Game\",\r\n            active: false\r\n        }\r\n    ];\r\n\r\n    constructor(\r\n        private _app: AppComponent,\r\n        private gameDatabaseService: GameDatabaseService,\r\n        private router: Router,\r\n        private route: ActivatedRoute,\r\n        private location: Location,\r\n        private userService: UserService\r\n    ) { }\r\n\r\n    ngOnInit(): void {\r\n        if (!this.game) {\r\n            this.route.params.forEach((params: Params) => {\r\n                let id = +params['id'];\r\n                this.gameDatabaseService.getGame(id)\r\n                    .then(game => this.setGame(game));\r\n            });\r\n        } else {\r\n            this.dialog = true;\r\n            this.setGame(this.game);\r\n        }\r\n\r\n        this.permissions = this.userService.getPermissions();\r\n        console.log(this.permissions);\r\n    }\r\n\r\n    ngOnDestroy(): void {\r\n\r\n    }\r\n\r\n    setGame(game: Game): void {\r\n        this.game = game;\r\n\r\n        this.gameDatabaseService.getPlayerCountById(this.game.PlayerCountID)\r\n            .then((playercount) => this.playerCount = playercount);\r\n\r\n        this.gameDatabaseService.getDurationById(this.game.DurationID)\r\n            .then((duration) => this.duration = duration);\r\n\r\n        this.game.TagGames.forEach((tagGame) => {\r\n            this.gameDatabaseService.getTagById(tagGame.TagID)\r\n                .then((tag) => {\r\n                    this.tagMap[tag.TagID] = tag.Name;\r\n                    this.tags.push(tag)\r\n                });\r\n        });\r\n\r\n        this.gameDatabaseService.getNotesForGame(this.game)\r\n            .then((notes) => this.notes = notes);\r\n    }\r\n\r\n    closePage(): void {\r\n        if (this.dialog) {\r\n            this.onClose.emit();\r\n        } else {\r\n            this.router.navigate(['/games']);\r\n        }\r\n    }\r\n\r\n    onScroll($event): void {\r\n        this.scrollpos = $event.target.scrollTop;\r\n    }\r\n\r\n    toggleNames(): void {\r\n        this.namesOpen = !this.namesOpen;\r\n    }\r\n\r\n    onToolClicked(tool: Tool): void {\r\n        switch (tool.name) {\r\n            case \"randomGame\":\r\n                if (this.dialog) {\r\n                    this.onClose.emit(tool);\r\n                } else {\r\n                    this.router.navigate(['/games', {random: 'random'}]);\r\n                }\r\n                break;\r\n            case \"deleteGame\":\r\n                this._app.dialog(\"Delete Game?\",\r\n                    \"Are you sure you want to delete this game. There is no turning back from this.\",\r\n                    \"Delete\",\r\n                    () => {\r\n                        this.gameDatabaseService.deleteGame(this.game)\r\n                            .then(() => {\r\n                                this.closePage();\r\n                            })\r\n                    });\r\n                break;\r\n        }\r\n    }\r\n\r\n\r\n\r\n}"]}