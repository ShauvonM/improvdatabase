{"version":3,"sources":["../../app/src/app/component/admin.component.ts"],"names":[],"mappings":"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","file":"admin.component.js","sourcesContent":["import { Component, OnInit, ViewChild } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\n\r\nimport {AppComponent} from '../../component/app.component';\r\nimport { Tool } from '../view/toolbar.view';\r\n\r\nimport { TabData } from '../../model/tab-data';\r\n\r\nimport { LibraryService } from '../service/library.service';\r\n\r\nimport { Subscription } from '../../model/subscription';\r\nimport { Package } from '../../model/package';\r\nimport { MaterialItem, MaterialItemVersion } from '../../model/material-item';\r\n\r\nimport { UserService } from '../../service/user.service';\r\n\r\nimport { TimeUtil } from '../../util/time.util';\r\n\r\nimport { AppHttp } from '../../data/app-http';\r\n\r\nimport { Util } from '../../util/util';\r\nimport { DialogAnim } from '../../util/anim.util';\r\n\r\n@Component({\r\n    moduleId: module.id,\r\n    selector: \"admin\",\r\n    templateUrl: \"../template/admin.component.html\",\r\n    animations: [DialogAnim.dialog]\r\n})\r\nexport class AdminComponent implements OnInit {\r\n\r\n    @ViewChild('versionFileInput', {read: HTMLInputElement}) versionFileInput: HTMLInputElement;\r\n\r\n    title: string = '<span class=\"light\">super</span><strong>admin</strong>';\r\n\r\n    tabs: TabData[] = [\r\n        {\r\n            name: 'Material Items',\r\n            id: 'materials',\r\n            icon: 'file'\r\n        },\r\n        {\r\n            name: 'Packages',\r\n            id: 'packages',\r\n            icon: 'book'\r\n        }\r\n    ];\r\n    selectedTab: string = 'materials';\r\n\r\n    materialItems: MaterialItem[];\r\n    selectedMaterial: MaterialItem;\r\n\r\n    newVersion: MaterialItemVersion;\r\n    newVersionFile: File;\r\n\r\n    packages: Package[];\r\n    selectedPackage: Package;\r\n    selectedPackageDescription: string;\r\n\r\n    selectPackageDialogVisible: boolean;\r\n    selectMaterialDialogVisible: boolean;\r\n\r\n    constructor(\r\n        public _app: AppComponent,\r\n        private router: Router,\r\n        private libraryService: LibraryService,\r\n        private userService: UserService,\r\n        private http: AppHttp\r\n    ) { }\r\n\r\n    _tools: Tool[] = [\r\n        {\r\n            icon: \"fa-database\",\r\n            name: \"backup\",\r\n            text: \"Back Up Database\"\r\n        }\r\n    ]\r\n\r\n    onToolClicked(tool: Tool): void {\r\n        switch (tool.name) {\r\n            case \"backup\":\r\n                this.doBackup();\r\n                break;\r\n        }\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        this.showMaterials();\r\n        this.showPackages();\r\n    }\r\n\r\n    selectTab(tab: TabData): void {\r\n        this.selectedTab = tab.id;\r\n    }\r\n\r\n    back(): void {\r\n        this.selectedMaterial = null;\r\n        this.selectedPackage = null;\r\n    }\r\n\r\n    simpleDate(date: string): string {\r\n        return TimeUtil.simpleDate(date);\r\n    }\r\n\r\n    showMaterials(): void {\r\n        this.libraryService.getAllMaterials()\r\n            .then(materials => {\r\n                this._app.hideLoader();\r\n                this.materialItems = materials;\r\n            });\r\n    }\r\n\r\n    showPackages(): void {\r\n        this.libraryService.getAllPackages()\r\n            .then(packages => {\r\n                this.packages = packages;\r\n            })\r\n    }\r\n\r\n    selectMaterial(material: MaterialItem): void {\r\n        this.newVersion = new MaterialItemVersion();\r\n        this.selectedMaterial = material;\r\n    }\r\n\r\n    selectPackage(p: Package): void {\r\n        this.selectedPackage = p;\r\n\r\n        this.selectedPackageDescription = p.description.join('\\n');\r\n    }\r\n\r\n    createMaterial(): void {\r\n        this.libraryService.createMaterial().then(m => {\r\n            this.materialItems.push(m);\r\n            this.selectMaterial(m);\r\n        });\r\n    }\r\n\r\n    createPackage(): void {\r\n        this.libraryService.createPackage().then(p => {\r\n            this.packages.push(p);\r\n            this.selectPackage(p);\r\n        })\r\n    }\r\n\r\n    saveMaterial(): void {\r\n        if (typeof(this.selectedMaterial.tags) == 'string') {\r\n            let tags:string = this.selectedMaterial.tags;\r\n            let tagArray:string[] = [];\r\n            tags.split(',').forEach(t => {\r\n                tagArray.push(t.trim());\r\n            });\r\n            this.selectedMaterial.tags = tagArray;\r\n        }\r\n        this.libraryService.saveMaterial(this.selectedMaterial).then(() => {\r\n            this._app.toast('It is done.');\r\n        });\r\n    }\r\n\r\n    savePackage(): void {\r\n        let descArray = this.selectedPackageDescription.split('\\n');\r\n\r\n        this.selectedPackage.description = descArray;\r\n        this.libraryService.savePackage(this.selectedPackage).then(() => {\r\n            this._app.toast('It is done.');\r\n        });\r\n    }\r\n\r\n    fileChange(): void {\r\n        this.newVersionFile = this.versionFileInput.files[0];\r\n    }\r\n\r\n    saveVersion(): void {\r\n        this.libraryService.postNewVersion(this.selectedMaterial._id, this.newVersion, this.newVersionFile).then(m => {\r\n            this.selectedMaterial.versions = m.versions;\r\n\r\n            this.userService.refreshToken();\r\n        });\r\n    }\r\n\r\n    deleteVersion(version: MaterialItemVersion): void {\r\n        this.libraryService.deleteVersion(this.selectedMaterial._id, version).then(m => {\r\n            this.selectedMaterial.versions = m.versions;\r\n        })\r\n    }\r\n\r\n    doBackup(): void {\r\n        this.http.get('/api/backup').toPromise().then(response => {\r\n            let data = response.json();\r\n            this._app.toast(data.timestamp);\r\n        })\r\n    }\r\n\r\n    deleteMaterial(): void {\r\n        this._app.showLoader();\r\n        this.libraryService.deleteMaterial(this.selectedMaterial).then(() => {\r\n            let index = Util.indexOfId(this.materialItems, this.selectedMaterial);\r\n            if (index > -1) {\r\n                this.materialItems.splice(index, 1);\r\n            }\r\n            this.selectedMaterial = null;\r\n            this._app.hideLoader();\r\n        });\r\n    }\r\n\r\n    deletePackage(): void {\r\n        this._app.showLoader();\r\n        this.libraryService.deletePackage(this.selectedPackage).then(() => {\r\n            let index = Util.indexOfId(this.packages, this.selectedPackage);\r\n            if (index > -1) {\r\n                this.packages.splice(index, 1);\r\n            }\r\n            this.selectedPackage = null;\r\n            this._app.hideLoader();\r\n        });\r\n    }\r\n\r\n    removePackageFromPackage(pkg: Package): void {\r\n        let index = Util.indexOfId(this.selectedPackage.packages, pkg);\r\n        this.selectedPackage.packages.splice(index, 1);\r\n        this.libraryService.savePackagePackages(this.selectedPackage)\r\n            .then(() => {\r\n                this._app.toast('Package Packages saved');\r\n            });\r\n    }\r\n\r\n    removeMaterialFromPackage(material: MaterialItem): void {\r\n        let index = Util.indexOfId(this.selectedPackage.materials, material);\r\n        this.selectedPackage.materials.splice(index, 1);\r\n        this.libraryService.savePackageMaterials(this.selectedPackage)\r\n            .then(() => {\r\n                this._app.toast('Package Materials saved');\r\n            });\r\n    }\r\n\r\n    packagePackagesDropped(droppedId: string, ontoId: string): void {\r\n        let indexFrom, indexTo;\r\n        indexFrom = Util.indexOfId(this.selectedPackage.packages, droppedId);\r\n        indexTo = Util.indexOfId(this.selectedPackage.packages, ontoId);\r\n\r\n        let packageToMove = this.selectedPackage.packages[indexFrom];\r\n        this.selectedPackage.packages.splice(indexFrom, 1);\r\n        this.selectedPackage.packages.splice(indexTo, 0, packageToMove);\r\n\r\n        this.libraryService.savePackagePackages(this.selectedPackage)\r\n            .then(() => {\r\n                this._app.toast('Package Packages saved');\r\n            });\r\n    }\r\n\r\n    packageMaterialsDropped(droppedId: string, ontoId: string): void {\r\n        let indexFrom, indexTo;\r\n        indexFrom = Util.indexOfId(this.selectedPackage.materials, droppedId);\r\n        indexTo = Util.indexOfId(this.selectedPackage.materials, ontoId);\r\n\r\n        let materialToMove = this.selectedPackage.materials[indexFrom];\r\n        this.selectedPackage.materials.splice(indexFrom, 1);\r\n        this.selectedPackage.materials.splice(indexTo, 0, materialToMove);\r\n\r\n        this.libraryService.savePackageMaterials(this.selectedPackage)\r\n            .then(() => {\r\n                this._app.toast('Package Materials saved');\r\n            });\r\n    }\r\n\r\n    cancelSelectMaterialDialog(): void {\r\n        this.selectMaterialDialogVisible = false;\r\n        this.selectPackageDialogVisible = false;\r\n        this._app.backdrop(false);\r\n    }\r\n\r\n    showSelectMaterialDialog(): void {\r\n        this.selectMaterialDialogVisible = true;\r\n        this.selectPackageDialogVisible = false;\r\n        this._app.backdrop(true);\r\n    }\r\n\r\n    showSelectPackageDialog(): void {\r\n        this.selectPackageDialogVisible = true;\r\n        this.selectMaterialDialogVisible = false;\r\n        this._app.backdrop(true);\r\n    }\r\n\r\n    selectPackageForPackage(pkg: Package): void {\r\n        this.selectedPackage.packages.push(pkg);\r\n\r\n        this.libraryService.savePackagePackages(this.selectedPackage)\r\n            .then(() => {\r\n                this._app.toast('Package Packages saved');\r\n            });\r\n    }\r\n\r\n    selectMaterialForPackage(material: MaterialItem): void {\r\n        this.selectedPackage.materials.push(material);\r\n\r\n        this.libraryService.savePackageMaterials(this.selectedPackage)\r\n            .then(() => {\r\n                this._app.toast('Package Materials saved');\r\n            });\r\n    }\r\n\r\n}\r\n"]}