{"version":3,"sources":["../src/ts/app/component/app.component.ts"],"names":[],"mappings":"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","file":"app.component.js","sourcesContent":["import {\r\n    Component,\r\n    OnInit,\r\n    OnDestroy,\r\n    Renderer,\r\n    Injectable,\r\n    trigger,\r\n    state,\r\n    style,\r\n    transition,\r\n    animate\r\n} from '@angular/core';\r\nimport 'rxjs/Subject';\r\nimport { Subject } from 'rxjs/Subject';\r\nimport { Subscription } from 'rxjs/Subscription';\r\nimport { Router, NavigationStart, RoutesRecognized } from '@angular/router';\r\n\r\nimport { User } from \"../model/user\";\r\nimport { UserService } from '../service/user.service';\r\n\r\nimport { DialogAnim } from '../util/anim.util';\r\n\r\n@Component({\r\n    moduleId: module.id,\r\n    selector: 'my-app',\r\n    templateUrl: '../template/app.component.html',\r\n    animations: [\r\n        DialogAnim.dialog\r\n    ]\r\n})\r\nexport class AppComponent implements OnInit, OnDestroy {\r\n\r\n    loader = document.getElementById(\"siteLoader\");\r\n    showMenu: boolean = false;\r\n    showFullscreen: boolean = false;\r\n\r\n    scrollpos: number;\r\n    showToolbarScrollPosition: number = 20;\r\n    toolbarVisible: boolean;\r\n\r\n    backgroundVisible: boolean;\r\n\r\n    redirectUrl: string;\r\n\r\n    user: User;\r\n\r\n    showDialog: boolean = false;\r\n    dialogTitle: string = \"\";\r\n    dialogMessage: string = \"\";\r\n    dialogConfirm: string = \"\";\r\n    dialogOnConfirm: Function;\r\n\r\n    showLogin: boolean;\r\n    showBackdrop: boolean;\r\n\r\n    userSubscription: Subscription;\r\n\r\n    version: string = \"1.1.0\";\r\n\r\n    constructor(\r\n        private _renderer: Renderer,\r\n        private router: Router,\r\n        private userService: UserService\r\n    ) {\r\n        router.events.subscribe(val => {\r\n            if (val instanceof NavigationStart) {\r\n                // if no user is logged in, redirect them to the login screen\r\n                if (this.userService.getLoggedInUser()) {\r\n                    this.setUser(this.userService.getLoggedInUser());\r\n                } else if (val.url !== '/login') {\r\n                    this.redirectUrl = val.url;\r\n                    this.router.navigate(['/login']);\r\n                }\r\n            } else if (val instanceof RoutesRecognized) {\r\n                this.showBackground(false);\r\n            }\r\n        })\r\n    }\r\n\r\n    ngOnInit() {\r\n        this.hideLoader();\r\n\r\n        this.userSubscription = this.userService.loginState$.subscribe(user => {\r\n            this.setUser(user)\r\n            let redirect = this.redirectUrl;\r\n            if (!redirect) {\r\n                redirect = \"/dashboard\";\r\n            }\r\n            this.router.navigate([redirect]);\r\n        });\r\n    }\r\n\r\n    ngOnDestroy() {\r\n        this.userSubscription.unsubscribe();\r\n    }\r\n    \r\n    onScroll($event): void {\r\n        this.scrollpos = $event.target.scrollingElement.scrollTop;\r\n        this.toolbarVisible = this.scrollpos > this.showToolbarScrollPosition;\r\n    }\r\n\r\n    showBackground(show: boolean): void {\r\n        this.backgroundVisible = show;\r\n    }\r\n\r\n    setUser(user: User): void {\r\n        this.user = user;\r\n    }\r\n\r\n    showLoader(): void {\r\n        this.loader.style.display = \"block\";\r\n    }\r\n\r\n    hideLoader(): void {\r\n        this.loader.style.display = \"none\";\r\n    }\r\n\r\n    toggleNav(): void {\r\n        this.showMenu = !this.showMenu;\r\n        this.showBackdrop = this.showMenu;\r\n    }\r\n\r\n    closeOverlays(): void {\r\n        if (this.user) {\r\n            this.showDialog = false;\r\n            this.showMenu = false;\r\n            this.showLogin = false;\r\n            this.showBackdrop = false;\r\n        }\r\n    }\r\n\r\n    fullscreen(): void {\r\n        // are we full-screen?\r\n        if (document.fullscreenElement ||\r\n            document.webkitFullscreenElement) {\r\n            \r\n            // exit full-screen\r\n            if (document.exitFullscreen) {\r\n                document.exitFullscreen();\r\n            } else if (document.webkitExitFullscreen) {\r\n                document.webkitExitFullscreen();\r\n            }\r\n\r\n            this.showFullscreen = false;\r\n        } else {\r\n            var i = document.body;\r\n            // go full-screen\r\n            if (i.requestFullscreen) {\r\n                i.requestFullscreen();\r\n            } else if (i.webkitRequestFullscreen) {\r\n                i.webkitRequestFullscreen();\r\n            }\r\n\r\n            this.showFullscreen = true;\r\n        }\r\n    }\r\n\r\n    dialog(title: string, body: string, button: string, onConfirm?: Function): void {\r\n        this.dialogTitle = title;\r\n        this.dialogMessage = body;\r\n        this.dialogConfirm = button;\r\n        this.dialogOnConfirm = onConfirm;\r\n\r\n        this.showDialog = true;\r\n        this.showBackdrop = true;\r\n    }\r\n\r\n    onDialogDismiss(): void {\r\n        this.closeOverlays();\r\n    }\r\n\r\n    onDialogConfirm(): void {\r\n        if (this.dialogOnConfirm) {\r\n            if (this.dialogOnConfirm() !== false) {\r\n                this.closeOverlays();\r\n            }\r\n        } else {\r\n            this.closeOverlays();\r\n        }\r\n    }\r\n\r\n    login(): void {\r\n        this.closeOverlays();\r\n        this.showLogin = true;\r\n        this.showBackdrop = true;\r\n    }\r\n\r\n    handleLogin(user: User): void {\r\n        this.closeOverlays();\r\n    }\r\n}\r\n"]}