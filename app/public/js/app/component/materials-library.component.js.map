{"version":3,"sources":["../../src/ts/app/component/materials-library.component.ts"],"names":[],"mappings":"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","file":"materials-library.component.js","sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { PathLocationStrategy } from '@angular/common';\r\nimport { Router, ActivatedRoute, Params } from '@angular/router';\r\n\r\nimport {AppComponent    } from '../../component/app.component';\r\nimport { Tool, SearchResult } from '../view/toolbar.view';\r\n\r\nimport { LibraryService } from '../../service/library.service';\r\n\r\nimport { Subscription } from '../../model/subscription';\r\nimport { Package, PackageMaterial } from '../../model/package';\r\nimport { MaterialItem } from '../../model/material-item';\r\n\r\nimport { UserService } from '../../service/user.service';\r\n\r\n@Component({\r\n    moduleId: module.id,\r\n    selector: \"packages\",\r\n    templateUrl: \"../template/materials-library.component.html\"\r\n})\r\nexport class MaterialsLibraryComponent implements OnInit {\r\n\r\n    title: string = '<span class=\"light\">materials</span><strong>library</strong>';\r\n\r\n    filter: boolean; // TODO\r\n    searchResults: SearchResult[] = [];\r\n\r\n    subscriptions: Subscription[];\r\n    // packages: Package[];\r\n    // materials: MaterialItem[];\r\n\r\n    selectedSubscription: Subscription;\r\n\r\n    constructor(\r\n        private _app: AppComponent,\r\n        private router: Router,\r\n        private route: ActivatedRoute,\r\n        private libraryService: LibraryService,\r\n        private pathLocationStrategy: PathLocationStrategy\r\n    ) { }\r\n\r\n    private _tools: Tool[] = [\r\n    ]\r\n\r\n    ngOnInit(): void {\r\n\r\n        let slug;\r\n\r\n        this.route.params.forEach((params: Params) => {\r\n            slug = params['packageSlug'];\r\n        });\r\n\r\n        this.getLibrary(slug);\r\n\r\n        this.pathLocationStrategy.onPopState(() => {\r\n            this.selectedSubscription = null;\r\n            this.getLibrary('');\r\n        });\r\n    }\r\n\r\n    onToolClicked(tool: Tool): void {\r\n        \r\n    }\r\n\r\n    getLibrary(slug: string): void {\r\n        // Promise.all([\r\n        //         this.libraryService.getLibrary()\r\n        //     ]).then((items) => {\r\n        //         setTimeout(() => {\r\n        //             this._app.hideLoader();\r\n        //             this.materials = items[0];\r\n        //             this.packages = items[1];\r\n        //         }, 150);\r\n        //     });\r\n        this._app.showLoader();\r\n\r\n        if (slug) {\r\n\r\n            this.libraryService.getSubscription(slug)\r\n                .then(sub => {\r\n                    this.selectSubscription(sub);\r\n                })\r\n\r\n        } else {\r\n            this._app.showBackground(true);\r\n\r\n            this.libraryService.getSubscriptions()\r\n                .then(subs => {\r\n                    this.subscriptions = subs;\r\n                    this._app.hideLoader();\r\n                });\r\n\r\n        }\r\n    }\r\n\r\n    selectSubscription(sub: Subscription): void {\r\n        this.selectedSubscription = sub;\r\n        this._app.showBackground(false);\r\n        this._app.hideLoader();\r\n\r\n        let newPath = '/materials/' + sub.package.slug;\r\n        this._app.setPath(newPath);\r\n\r\n        window.scrollTo(0,0);\r\n    }\r\n\r\n    clearFilter(): void {\r\n        if (this.selectedSubscription) {\r\n            this.pathLocationStrategy.back();\r\n        }\r\n    }\r\n\r\n    selectMaterial(material: MaterialItem): void {\r\n        this.libraryService.downloadMaterial(material._id);\r\n    }\r\n\r\n    versionTag(m: MaterialItem): string {\r\n        let v = this.libraryService.getLatestVersionForMaterialItem(m);\r\n        // TODO: show the date this was released\r\n        return \"version \" + v.ver;\r\n    }\r\n\r\n}\r\n"]}