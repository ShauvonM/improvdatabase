{"version":3,"sources":["../../src/ts/app/component/team-details.component.ts"],"names":[],"mappings":"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","file":"team-details.component.js","sourcesContent":["import { Component, OnInit, Input } from '@angular/core';\r\nimport { Router, ActivatedRoute, Params } from '@angular/router';\r\n\r\nimport {AppComponent} from '../../component/app.component';\r\nimport { Tool } from '../view/toolbar.view';\r\n\r\nimport { User } from '../../model/user';\r\nimport { Team } from '../../model/team';\r\nimport { Address } from '../../model/address';\r\n\r\nimport { UserService } from '../../service/user.service';\r\nimport { TeamService } from '../../service/team.service';\r\n\r\nimport { TimeUtil } from '../../util/time.util';\r\n\r\nimport { DialogAnim, ToggleAnim } from '../../util/anim.util';\r\n\r\n@Component({\r\n    moduleId: module.id,\r\n    selector: \"team-details\",\r\n    templateUrl: \"../template/team-details.component.html\",\r\n    animations: [DialogAnim.dialog]\r\n})\r\nexport class TeamDetailsComponent implements OnInit {\r\n\r\n    @Input() team: Team;\r\n    user: User;\r\n\r\n    private adminActions = [\r\n        'team_edit'\r\n    ]\r\n\r\n    address: string;\r\n    remainingSubs: number;\r\n    pendingInvites: number;\r\n\r\n    selectedUser: User;\r\n\r\n    isPosting: boolean;\r\n\r\n    constructor(\r\n        private _app: AppComponent,\r\n        private route: ActivatedRoute,\r\n        private userService: UserService,\r\n        private teamService: TeamService\r\n    ) { }\r\n\r\n    private _tools: Tool[] = [\r\n    ]\r\n\r\n    _timeUtil = TimeUtil;\r\n\r\n    ngOnInit(): void {\r\n        this.user = this.userService.getLoggedInUser();\r\n\r\n        this.route.params.forEach((params: Params) => {\r\n            let id = params['id'];\r\n            this.getTeam(id);\r\n        });\r\n    }\r\n\r\n    getTeam(id: string): void {\r\n        this.teamService.getTeam(id)\r\n            .then(team => this.setTeam(team));\r\n    }\r\n\r\n    can(action: string): boolean {\r\n        let can = this.userService.can(action);\r\n\r\n        if (this.adminActions.indexOf(action)) {\r\n            return can && this.isUserAdmin();\r\n        } else {\r\n            return can;\r\n        }\r\n    }\r\n\r\n    isUserAdmin(): boolean {\r\n        return this.userService.isAdminOfTeam(this.team);\r\n    }\r\n\r\n    setTeam(team: Team): void {\r\n        this.team = team;\r\n\r\n        console.log(this.team);\r\n\r\n        this.remainingSubs = team.subscription.subscriptions - team.subscription.children.length;\r\n        this.pendingInvites = team.subscription.invites.length;\r\n    }\r\n\r\n    saveEditName(name: string): void {\r\n        this.team.name = name;\r\n        this.teamService.saveTeam(this.team);\r\n    }\r\n\r\n    saveEditPhone(phone: string): void {\r\n        this.team.phone = phone;\r\n        this.teamService.saveTeam(this.team);\r\n    }\r\n\r\n    saveEditEmail(email: string): void {\r\n        this.team.email = email;\r\n        this.teamService.saveTeam(this.team);\r\n    }\r\n\r\n    saveEditUrl(url: string): void {\r\n        this.team.url = url;\r\n        this.teamService.saveTeam(this.team);\r\n    }\r\n\r\n    saveEditCompany(company: string): void {\r\n        this.team.company = company;\r\n        this.teamService.saveTeam(this.team);\r\n    }\r\n\r\n    saveEditAddress(address: Address): void {\r\n        this.team.address = address.address;\r\n        this.team.city = address.city;\r\n        this.team.state = address.state;\r\n        this.team.zip = address.zip;\r\n        this.team.country = address.country;\r\n\r\n        this.teamService.saveTeam(this.team);\r\n    }\r\n\r\n    newDescriptionText: string;\r\n    editDescriptionShown: boolean;\r\n    showEditDescription(): void {\r\n        if (this.can('team_edit')) {\r\n            this.newDescriptionText = this.team.description;\r\n            this.editDescriptionShown = true;\r\n        }\r\n    }\r\n\r\n    cancelDescription(): void {\r\n        this.editDescriptionShown = false;\r\n    }\r\n\r\n    saveDescription(): void {\r\n        this.team.description = this.newDescriptionText;\r\n        this.teamService.saveTeam(this.team);\r\n        this.cancelDescription();\r\n    }\r\n\r\n    selectUser(user: User): void {\r\n        if (this.selectedUser !== user) {\r\n            this.selectedUser = user;\r\n        } else {\r\n            this.selectedUser = null;\r\n        }\r\n    }\r\n\r\n    showInviteDialog: boolean;\r\n    inviteEmail: string;\r\n    inviteStatus: string;\r\n\r\n    invite(): void {\r\n        this._app.backdrop(true);\r\n\r\n        this.showInviteDialog = true;\r\n        this.inviteEmail = '';\r\n    }\r\n\r\n    cancelInvite(): void {\r\n        this._app.backdrop(false);\r\n        \r\n        this.showInviteDialog = false;\r\n        this.inviteStatus = '';\r\n    }\r\n\r\n    submitInvite(): void {\r\n        this.isPosting = true;\r\n\r\n        this.teamService.invite(this.team, this.inviteEmail)\r\n            .then(msg => {\r\n                this.isPosting = false;\r\n                this.inviteStatus = 'wait';\r\n                setTimeout(() => {\r\n                    this.inviteStatus = msg;\r\n                    this.getTeam(this.team._id);\r\n                }, 300);\r\n            })\r\n    }\r\n\r\n    leave(): void {\r\n        this._app.toast(\"This button doesn't work yet. I'm afraid you're stuck for now.\");\r\n    }\r\n\r\n}\r\n"]}