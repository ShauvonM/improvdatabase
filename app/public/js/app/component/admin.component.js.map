{"version":3,"sources":["../../src/ts/app/component/admin.component.ts"],"names":[],"mappings":"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","file":"admin.component.js","sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\n\r\nimport {AppComponent} from '../../component/app.component';\r\nimport { Tool } from '../view/toolbar.view';\r\n\r\nimport { LibraryService } from '../../service/library.service';\r\n\r\nimport { Subscription } from '../../model/subscription';\r\nimport { Package } from '../../model/package';\r\nimport { MaterialItem, MaterialItemVersion } from '../../model/material-item';\r\n\r\nimport { UserService } from '../../service/user.service';\r\n\r\nimport { TimeUtil } from '../../util/time.util';\r\n\r\n@Component({\r\n    moduleId: module.id,\r\n    selector: \"admin\",\r\n    templateUrl: \"../template/admin.component.html\"\r\n})\r\nexport class AdminComponent implements OnInit {\r\n\r\n    title: string = '<span class=\"light\">super</span><strong>admin</strong>';\r\n\r\n    page: string;\r\n\r\n    materialItems: MaterialItem[];\r\n    selectedMaterial: MaterialItem;\r\n\r\n    newVersion: MaterialItemVersion;\r\n    newVersionFile: File\r\n\r\n    constructor(\r\n        private _app: AppComponent,\r\n        private router: Router,\r\n        private libraryService: LibraryService,\r\n        private userService: UserService\r\n    ) { }\r\n\r\n    private _tools: Tool[] = [\r\n    ]\r\n\r\n    ngOnInit(): void {\r\n        this.showMaterials();\r\n    }\r\n\r\n    back(): void {\r\n        this.selectedMaterial = null;\r\n    }\r\n\r\n    simpleDate(date: string): string {\r\n        return TimeUtil.simpleDate(date);\r\n    }\r\n\r\n    showMaterials(): void {\r\n        this.page = \"materials\";\r\n\r\n        this.libraryService.getAllMaterials()\r\n            .then(materials => {\r\n                this._app.hideLoader();\r\n                this.materialItems = materials;\r\n            });\r\n    }\r\n\r\n    selectMaterial(material: MaterialItem): void {\r\n        this.newVersion = new MaterialItemVersion();\r\n        this.selectedMaterial = material;\r\n    }\r\n\r\n    saveMaterial(): void {\r\n        if (typeof(this.selectedMaterial.tags) == 'string') {\r\n            let tags:string = this.selectedMaterial.tags;\r\n            let tagArray:string[] = [];\r\n            tags.split(',').forEach(t => {\r\n                tagArray.push(t.trim());\r\n            });\r\n            this.selectedMaterial.tags = tagArray;\r\n        }\r\n        this.libraryService.saveMaterial(this.selectedMaterial).then();\r\n    }\r\n\r\n    fileChange($event): void {\r\n        this.newVersionFile = $event.target.files[0];\r\n    }\r\n\r\n    saveVersion(): void {\r\n        this.libraryService.postNewVersion(this.selectedMaterial._id, this.newVersion, this.newVersionFile).then(m => {\r\n            this.selectedMaterial.versions = m.versions;\r\n\r\n            this.userService.refreshToken();\r\n        });\r\n    }\r\n\r\n    deleteVersion(version: MaterialItemVersion): void {\r\n        this.libraryService.deleteVersion(this.selectedMaterial._id, version).then(m => {\r\n            this.selectedMaterial.versions = m.versions;\r\n        })\r\n    }\r\n\r\n}\r\n"]}