{"version":3,"sources":["../../src/ts/app/view/editable-metadata.view.ts"],"names":[],"mappings":"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","file":"editable-metadata.view.js","sourcesContent":["import { \r\n    Component,\r\n    OnInit,\r\n    Input,\r\n    Output,\r\n    EventEmitter,\r\n    ViewChild,\r\n    ElementRef\r\n} from '@angular/core';\r\n\r\nimport { Address } from '../../model/address';\r\n\r\n@Component({\r\n    moduleId: module.id,\r\n    selector: '.improvplus-editable-metadata',\r\n    templateUrl: '../template/view/editable-metadata.view.html'\r\n})\r\nexport class EditableMetadataView implements OnInit {\r\n\r\n    @ViewChild('metadataInput') inputElement;\r\n\r\n    @Input() icon: string;\r\n    @Input() text: string;\r\n    @Input() blankText: string;\r\n    @Input() canEdit: boolean;\r\n\r\n    @Input() type: string = 'text';\r\n\r\n    @Output() save: EventEmitter<string> = new EventEmitter();\r\n    @Output() saveAddress: EventEmitter<Address> = new EventEmitter();\r\n\r\n    private editShown: boolean;\r\n\r\n    private editModel: string;\r\n\r\n    @Input() address: string;\r\n    @Input() city: string;\r\n    @Input() state: string;\r\n    @Input() zip: string;\r\n    @Input() country: string;\r\n\r\n    constructor(\r\n    ) { }\r\n\r\n    ngOnInit(): void {\r\n        if (this.address) {\r\n            this.type = 'address';\r\n        }\r\n\r\n        if (this.type == 'address') {\r\n            this.setupAddress();\r\n        }\r\n    }\r\n\r\n    private _focusInput(): void {\r\n        (<HTMLInputElement> this.inputElement.nativeElement).focus();\r\n    }\r\n\r\n    setupAddress(): void {\r\n        let address = this.address || '',\r\n            city = this.city || '',\r\n            state = this.state || '',\r\n            zip = this.zip || '',\r\n            country = this.country || '';\r\n\r\n        this.text = address;\r\n        if (address && (city || state || zip)) {\r\n            this.text += '<br />';\r\n        }\r\n        this.text += city + ' ' + state;\r\n        if ((city || state) && zip) {\r\n            this.text += ',';\r\n        }\r\n        this.text += ' ' + zip;\r\n        if (this.text && country) {\r\n            this.text += '<br />';\r\n        }\r\n        this.text += country;\r\n\r\n        this.text = this.text.trim();\r\n    }\r\n\r\n    showEdit(): void {\r\n        if (this.canEdit) {\r\n            this.editModel = this.text\r\n            this.editShown = true;\r\n            setTimeout(() => {\r\n                this._focusInput();\r\n            })\r\n        }\r\n    }\r\n\r\n    closeEdit(): void {\r\n        this.editShown = false;\r\n        this.editModel = this.text;\r\n    }\r\n\r\n    pressEnter(): void {\r\n        (<HTMLInputElement> this.inputElement.nativeElement).blur();\r\n    }\r\n\r\n    saveEdit(): void {\r\n        if (this.type == 'address') {\r\n            this.setupAddress();\r\n            this.saveAddress.emit({\r\n                address: this.address,\r\n                city: this.city,\r\n                state: this.state,\r\n                zip: this.zip,\r\n                country: this.country\r\n            });\r\n        } else if (this.editModel && this.editModel != this.text) {\r\n            this.text = this.editModel;\r\n            this.save.emit(this.editModel);\r\n        }\r\n\r\n        this.closeEdit();\r\n    }\r\n}\r\n"]}